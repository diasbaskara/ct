// ==UserScript==
// @name         CoreTabs
// @namespace    https://github.com/diasbaskara/ct
// @version      1.0.0
// @description  Enhanced CoreTabs userscript with modular architecture
// @author       diasbaskara
// @match        https://coretax.intranet.pajak.go.id/*
// @icon         https://www.google.com/s2/favicons?sz=64&domain=pajak.go.id
// @homepage     https://github.com/diasbaskara/ct
// @supportURL   https://github.com/diasbaskara/ct/issues
// @updateURL    https://cdn.jsdelivr.net/gh/diasbaskara/ct@main/cdn/latest/coretabs.meta.js
// @downloadURL  https://cdn.jsdelivr.net/gh/diasbaskara/ct@main/cdn/latest/coretabs.user.js
// @grant        GM_setValue
// @grant        GM_getValue
// @grant        GM_deleteValue

// ==/UserScript==
(()=>{"use strict";const e=document.createElement("style");e.textContent=":root {\r\n  --primary-color: #1976d2;\r\n  --secondary-color: #424242;\r\n  --success-color: #4caf50;\r\n  --warning-color: #ff9800;\r\n  --error-color: #f44336;\r\n  --info-color: #2196f3;\r\n  \r\n  --text-primary: #212121;\r\n  --text-secondary: #757575;\r\n  --text-disabled: #bdbdbd;\r\n  \r\n  --background-primary: #ffffff;\r\n  --background-secondary: #f5f5f5;\r\n  --background-paper: #ffffff;\r\n  \r\n  --border-color: #e0e0e0;\r\n  --divider-color: #e0e0e0;\r\n  \r\n  --shadow-1: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);\r\n  --shadow-2: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);\r\n  --shadow-3: 0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23);\r\n  \r\n  --border-radius: 4px;\r\n  --border-radius-large: 8px;\r\n  \r\n  --font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\r\n  --font-size-small: 12px;\r\n  --font-size-normal: 14px;\r\n  --font-size-large: 16px;\r\n  --font-size-xlarge: 18px;\r\n  \r\n  --spacing-xs: 4px;\r\n  --spacing-sm: 8px;\r\n  --spacing-md: 16px;\r\n  --spacing-lg: 24px;\r\n  --spacing-xl: 32px;\r\n  \r\n  --transition-fast: 0.15s ease;\r\n  --transition-normal: 0.3s ease;\r\n  --transition-slow: 0.5s ease;\r\n}";document.head.querySelector("style[data-userscript]")||(e.setAttribute("data-userscript","true"),document.head.appendChild(e));const n=document.createElement("style");n.textContent="/* CoreTabs Styles */\r\n.coretabs-sidebar {\r\n  position: fixed;\r\n  top: 0;\r\n  right: -400px;\r\n  width: 400px;\r\n  height: 100vh;\r\n  background: var(--background-paper);\r\n  box-shadow: var(--shadow-3);\r\n  z-index: 10000;\r\n  transition: right var(--transition-normal);\r\n  font-family: var(--font-family);\r\n  font-size: var(--font-size-normal);\r\n  overflow: hidden;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.coretabs-sidebar.open {\r\n  right: 0;\r\n}\r\n\r\n.coretabs-header {\r\n  background: var(--primary-color);\r\n  color: white;\r\n  padding: var(--spacing-md);\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.coretabs-title {\r\n  font-size: var(--font-size-large);\r\n  font-weight: 600;\r\n  margin: 0;\r\n}\r\n\r\n.coretabs-close {\r\n  background: none;\r\n  border: none;\r\n  color: white;\r\n  font-size: var(--font-size-xlarge);\r\n  cursor: pointer;\r\n  padding: var(--spacing-xs);\r\n  border-radius: var(--border-radius);\r\n  transition: background-color var(--transition-fast);\r\n}\r\n\r\n.coretabs-close:hover {\r\n  background-color: rgba(255, 255, 255, 0.1);\r\n}\r\n\r\n.coretabs-content {\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  padding: var(--spacing-md);\r\n}\r\n\r\n.coretabs-profile {\r\n  background: var(--background-secondary);\r\n  padding: var(--spacing-md);\r\n  border-radius: var(--border-radius);\r\n  margin-bottom: var(--spacing-md);\r\n}\r\n\r\n.coretabs-profile-name {\r\n  font-weight: 600;\r\n  color: var(--text-primary);\r\n  margin-bottom: var(--spacing-xs);\r\n}\r\n\r\n.coretabs-profile-role {\r\n  color: var(--text-secondary);\r\n  font-size: var(--font-size-small);\r\n}\r\n\r\n.coretabs-tabs {\r\n  display: flex;\r\n  border-bottom: 1px solid var(--border-color);\r\n  margin-bottom: var(--spacing-md);\r\n}\r\n\r\n.coretabs-tab {\r\n  background: none;\r\n  border: none;\r\n  padding: var(--spacing-sm) var(--spacing-md);\r\n  cursor: pointer;\r\n  border-bottom: 2px solid transparent;\r\n  transition: all var(--transition-fast);\r\n  color: var(--text-secondary);\r\n  font-size: var(--font-size-normal);\r\n}\r\n\r\n.coretabs-tab.active {\r\n  color: var(--primary-color);\r\n  border-bottom-color: var(--primary-color);\r\n}\r\n\r\n.coretabs-tab:hover {\r\n  background-color: var(--background-secondary);\r\n}\r\n\r\n.coretabs-tab-content {\r\n  display: none;\r\n}\r\n\r\n.coretabs-tab-content.active {\r\n  display: block;\r\n}\r\n\r\n.coretabs-loading {\r\n  text-align: center;\r\n  padding: var(--spacing-lg);\r\n  color: var(--text-secondary);\r\n}\r\n\r\n.coretabs-error {\r\n  background: #ffebee;\r\n  color: var(--error-color);\r\n  padding: var(--spacing-md);\r\n  border-radius: var(--border-radius);\r\n  margin-bottom: var(--spacing-md);\r\n  border-left: 4px solid var(--error-color);\r\n}\r\n\r\n.coretabs-toggle {\r\n  position: fixed;\r\n  top: 20px;\r\n  right: 20px;\r\n  background: var(--primary-color);\r\n  color: white;\r\n  border: none;\r\n  width: 50px;\r\n  height: 50px;\r\n  border-radius: 50%;\r\n  cursor: pointer;\r\n  box-shadow: var(--shadow-2);\r\n  z-index: 9999;\r\n  font-size: var(--font-size-large);\r\n  transition: all var(--transition-fast);\r\n}\r\n\r\n.coretabs-toggle:hover {\r\n  transform: scale(1.1);\r\n  box-shadow: var(--shadow-3);\r\n}\r\n\r\n.coretabs-table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n  margin-bottom: var(--spacing-md);\r\n}\r\n\r\n.coretabs-table th,\r\n.coretabs-table td {\r\n  padding: var(--spacing-sm);\r\n  text-align: left;\r\n  border-bottom: 1px solid var(--border-color);\r\n  font-size: var(--font-size-small);\r\n}\r\n\r\n.coretabs-table th {\r\n  background: var(--background-secondary);\r\n  font-weight: 600;\r\n  color: var(--text-primary);\r\n}\r\n\r\n.coretabs-table tr:hover {\r\n  background: var(--background-secondary);\r\n}\r\n\r\n.coretabs-badge {\r\n  display: inline-block;\r\n  padding: 2px 8px;\r\n  border-radius: 12px;\r\n  font-size: 11px;\r\n  font-weight: 500;\r\n  text-transform: uppercase;\r\n}\r\n\r\n.coretabs-badge.status-active {\r\n  background: #e8f5e8;\r\n  color: var(--success-color);\r\n}\r\n\r\n.coretabs-badge.status-pending {\r\n  background: #fff3e0;\r\n  color: var(--warning-color);\r\n}\r\n\r\n.coretabs-badge.status-completed {\r\n  background: #e3f2fd;\r\n  color: var(--info-color);\r\n}";document.head.querySelector("style[data-userscript]")||(n.setAttribute("data-userscript","true"),document.head.appendChild(n));const t=document.createElement("style");t.textContent="/* Responsive styles */\r\n@media (max-width: 768px) {\r\n  .coretabs-sidebar {\r\n    width: 100vw;\r\n    right: -100vw;\r\n  }\r\n  \r\n  .coretabs-sidebar.open {\r\n    right: 0;\r\n  }\r\n  \r\n  .coretabs-toggle {\r\n    top: 10px;\r\n    right: 10px;\r\n    width: 40px;\r\n    height: 40px;\r\n    font-size: var(--font-size-normal);\r\n  }\r\n  \r\n  .coretabs-content {\r\n    padding: var(--spacing-sm);\r\n  }\r\n  \r\n  .coretabs-table {\r\n    font-size: 11px;\r\n  }\r\n  \r\n  .coretabs-table th,\r\n  .coretabs-table td {\r\n    padding: var(--spacing-xs);\r\n  }\r\n}\r\n\r\n@media (max-width: 480px) {\r\n  .coretabs-header {\r\n    padding: var(--spacing-sm);\r\n  }\r\n  \r\n  .coretabs-title {\r\n    font-size: var(--font-size-normal);\r\n  }\r\n  \r\n  .coretabs-tabs {\r\n    flex-wrap: wrap;\r\n  }\r\n  \r\n  .coretabs-tab {\r\n    flex: 1;\r\n    min-width: 80px;\r\n    padding: var(--spacing-xs) var(--spacing-sm);\r\n    font-size: var(--font-size-small);\r\n  }\r\n}";document.head.querySelector("style[data-userscript]")||(t.setAttribute("data-userscript","true"),document.head.appendChild(t));const r={AUTH_STORAGE_KEY:"cats-angular-clientuser:https://coretax.intranet.pajak.go.id/identityprovider:cats-angular-client",DEFAULT_CASES_FILTER:"In Progress",REFUND_CASE_TYPE_NAME:"Pengembalian Melalui Pelaporan Surat Pemberitahuan (SPT)",I18N_STORAGE_KEY:"coretabs-language",SIDEBAR_STATE_KEY:"coretabs-sidebar-state",SIDEBAR_DATA_KEY:"coretabs-sidebar-data",API_ENDPOINTS:{CASES:"https://coretax.intranet.pajak.go.id/casemanagement/api/caselist/mycases",DOCUMENTS:"https://coretax.intranet.pajak.go.id/documentmanagement/api/casedocument/list",USERS:"https://coretax.intranet.pajak.go.id/casemanagement/api/caseuser/list",PROFILE:"https://coretax.intranet.pajak.go.id/casemanagement/api/generalinformation/view",ROUTING:"https://coretax.intranet.pajak.go.id/casemanagement/api/caserouting/view",DOWNLOAD:"https://coretax.intranet.pajak.go.id/documentmanagement/api/download"}},a={app:{title:"CoreTabs",toggle:"Toggle CoreTabs"},common:{loading:"Loading...",error:"Error occurred",retry:"Retry",close:"Close",save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",view:"View",download:"Download",print:"Print"},tabs:{cases:"My Cases",documents:"Documents",routing:"Routing",profile:"Profile"},cases:{title:"Case Management",caseNumber:"Case Number",status:"Status",type:"Type",createdDate:"Created Date",lastUpdate:"Last Update",assignee:"Assignee",priority:"Priority",noData:"No cases found"},documents:{title:"Document Management",fileName:"File Name",fileType:"Type",fileSize:"Size",uploadDate:"Upload Date",actions:"Actions",noData:"No documents found"},routing:{title:"Case Routing",step:"Step",assignee:"Assignee",status:"Status",date:"Date",comments:"Comments",noData:"No routing information"},profile:{title:"User Profile",name:"Name",role:"Role",department:"Department",email:"Email",phone:"Phone"},filters:{all:"All",active:"Active",pending:"Pending",completed:"Completed",inProgress:"In Progress"},update:{available:"Update Available",newVersion:"A new version of CoreTabs is available!",current:"Current",latest:"Latest",changelog:"What's New:",install:"Install Update",later:"Later",skip:"Skip This Version",checking:"Checking for updates...",upToDate:"You have the latest version",checkFailed:"Failed to check for updates"}},o={app:{title:"CoreTabs",toggle:"Toggle CoreTabs"},common:{loading:"Memuat...",error:"Terjadi kesalahan",retry:"Coba Lagi",close:"Tutup",save:"Simpan",cancel:"Batal",delete:"Hapus",edit:"Edit",view:"Lihat",download:"Unduh",print:"Cetak"},tabs:{cases:"Kasus Saya",documents:"Dokumen",routing:"Routing",profile:"Profil"},cases:{title:"Manajemen Kasus",caseNumber:"Nomor Kasus",status:"Status",type:"Jenis",createdDate:"Tanggal Dibuat",lastUpdate:"Update Terakhir",assignee:"Penanggung Jawab",priority:"Prioritas",noData:"Tidak ada kasus ditemukan"},documents:{title:"Manajemen Dokumen",fileName:"Nama File",fileType:"Jenis",fileSize:"Ukuran",uploadDate:"Tanggal Upload",actions:"Aksi",noData:"Tidak ada dokumen ditemukan"},routing:{title:"Routing Kasus",step:"Langkah",assignee:"Penanggung Jawab",status:"Status",date:"Tanggal",comments:"Komentar",noData:"Tidak ada informasi routing"},profile:{title:"Profil Pengguna",name:"Nama",role:"Peran",department:"Departemen",email:"Email",phone:"Telepon"},filters:{all:"Semua",active:"Aktif",pending:"Menunggu",completed:"Selesai",inProgress:"Sedang Berjalan"}},s={en:a,id:o};let i="en";function c(e,n=e){return s[i]?.[e]||n}function d(){const e=localStorage.getItem(r.AUTH_STORAGE_KEY);if(e)try{const n=JSON.parse(e);return n.access_token||n.accessToken}catch(e){return null}return null}function l(e=null){const n=d(),t={"Content-Type":"application/json",Accept:"application/json"};return n&&(t.Authorization=`Bearer ${n}`),e&&(t["X-Case-Url"]=e),t}function p(e){const n=document.querySelector("[data-profile]");if(n&&(n.textContent="",e)){const t=document.createElement("span");t.textContent=e.name||"Unknown User",t.className="profile-name";const r=document.createElement("span");r.textContent=e.role||"Unknown Role",r.className="profile-role",n.appendChild(t),n.appendChild(r)}}async function u(){try{const e=await fetch(r.API_ENDPOINTS.CASES,{method:"POST",headers:l(),body:JSON.stringify({filter:r.DEFAULT_CASES_FILTER,pageSize:50,pageNumber:1})});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){throw new Error(`Failed to fetch cases: ${e.message}`)}}function m(){const e=document.getElementById("coretabs-toggle"),n=document.getElementById("coretabs-sidebar"),t=document.getElementById("coretabs-close");e&&n&&e.addEventListener("click",()=>{n.classList.toggle("open")}),t&&n&&t.addEventListener("click",()=>{n.classList.remove("open")});document.querySelectorAll(".coretabs-tab").forEach(e=>{e.addEventListener("click",()=>{!function(e){document.querySelectorAll(".coretabs-tab").forEach(n=>{n.classList.remove("active"),n.dataset.tab===e&&n.classList.add("active")}),document.querySelectorAll(".coretabs-tab-content").forEach(e=>{e.classList.remove("active")});const n=document.getElementById(`tab-${e}`);n&&(n.classList.add("active"),async function(e){const n=document.querySelector(".coretabs-content");if(!n)return;for(;n.firstChild;)n.removeChild(n.firstChild);const t=document.createElement("div");t.className="coretabs-loading",t.textContent=c("common.loading"),n.appendChild(t);try{switch(e){case"cases":!function(e,n){if(!e||!e.data||0===e.data.length){const e=document.createElement("div");return e.textContent=c("cases.noData"),void n.appendChild(e)}const t=document.createElement("table");t.className="coretabs-table";const r=document.createElement("thead"),a=document.createElement("tr");[c("cases.caseNumber"),c("cases.status"),c("cases.type"),c("cases.lastUpdate")].forEach(e=>{const n=document.createElement("th");n.textContent=e,a.appendChild(n)}),r.appendChild(a),t.appendChild(r);const o=document.createElement("tbody");e.data.forEach(e=>{const n=document.createElement("tr"),t=document.createElement("td");t.textContent=e.caseNumber||"N/A",n.appendChild(t);const r=document.createElement("td"),a=document.createElement("span");a.className=`coretabs-badge status-${(e.status||"").toLowerCase().replace(" ","-")}`,a.textContent=e.status||"N/A",r.appendChild(a),n.appendChild(r);const s=document.createElement("td");s.textContent=e.caseType||"N/A",n.appendChild(s);const i=document.createElement("td");i.textContent=e.lastUpdate||"N/A",n.appendChild(i),o.appendChild(n)}),t.appendChild(o);for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(t)}(await u(),n);break;case"documents":{const e=document.createElement("div");for(e.textContent=c("documents.noData");n.firstChild;)n.removeChild(n.firstChild);n.appendChild(e);break}case"routing":{const e=document.createElement("div");for(e.textContent=c("routing.noData");n.firstChild;)n.removeChild(n.firstChild);n.appendChild(e);break}}}catch(e){for(;n.firstChild;)n.removeChild(n.firstChild);const t=document.createElement("div");t.className="coretabs-error",t.textContent=c("common.error"),n.appendChild(t)}}(e))}(e.dataset.tab)})}),document.addEventListener("click",t=>{n&&n.classList.contains("open")&&(n.contains(t.target)||e.contains(t.target)||n.classList.remove("open"))})}i=function(){const e=localStorage.getItem(r.I18N_STORAGE_KEY);return e&&s[e]?e:navigator.language.toLowerCase().startsWith("id")?"id":"en"}();new class{constructor(){this.state={},this.listeners={}}get(e){return this.state[e]}set(e,n){const t=this.state[e];this.state[e]=n,this.listeners[e]&&this.listeners[e].forEach(e=>{try{e(n,t)}catch(e){}})}subscribe(e,n){return this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(n),()=>{const t=this.listeners[e].indexOf(n);t>-1&&this.listeners[e].splice(t,1)}}getAll(){return{...this.state}}clear(){this.state={},this.listeners={}}notify(e,n){(this.listeners.get(e)||[]).forEach(e=>{try{e(n)}catch(e){}})}};function b(){const e=document.getElementById("coretabs-sidebar");if(e){new MutationObserver(n=>{n.forEach(n=>{if("attributes"===n.type&&"class"===n.attributeName){!function(e){try{return localStorage.setItem(SIDEBAR_STATE_KEY,JSON.stringify(e)),!0}catch(e){return!1}}({isOpen:e.classList.contains("open")})}})}).observe(e,{attributes:!0,attributeFilter:["class"]})}setInterval(()=>{!async function(e,n){try{const t=JSON.stringify(n);return await GM_setValue(e,t),!0}catch(e){return!1}}()},3e4)}const g=class{constructor(e,n){this.currentVersion=e||"1.0.0",this.cdnBaseUrl=n||"https://cdn.jsdelivr.net/gh/diasbaskara/ct@main/cdn",this.checkInterval=864e5,this.lastCheckKey="coretabs_last_update_check"}async checkForUpdates(e=!1){try{if(!e&&!this.shouldCheck())return null;const n=await this.fetchVersionsData();if(!n)return null;const t=n.latest,r=this.compareVersions(t,this.currentVersion)>0;if("undefined"!=typeof GM_setValue?await GM_setValue(this.lastCheckKey,Date.now()):localStorage.setItem(this.lastCheckKey,Date.now().toString()),r){const e={currentVersion:this.currentVersion,latestVersion:t,releaseNotes:n.versions[t]?.notes||"",downloadUrl:`${this.cdnBaseUrl}/latest/coretabs.user.js`};return this.showUpdateNotification(e),e}return null}catch(e){return null}}async fetchVersionsData(){try{return new Promise(e=>{if("undefined"==typeof GM_xmlhttpRequest)return void e(null);const n=setTimeout(()=>{e(null)},1e4);GM_xmlhttpRequest({method:"GET",url:`${this.cdnBaseUrl}/versions.json`,timeout:1e4,onload:t=>{clearTimeout(n);try{const n=JSON.parse(t.responseText);e(n)}catch(n){e(null)}},onerror:()=>{clearTimeout(n),e(null)},ontimeout:()=>{clearTimeout(n),e(null)}})})}catch(e){return null}}shouldCheck(){try{let e;if("undefined"!=typeof GM_getValue)e=GM_getValue(this.lastCheckKey,0);else{const n=localStorage.getItem(this.lastCheckKey);e=n?parseInt(n):0}if(!e)return!0;return Date.now()-e>this.checkInterval}catch(e){return!0}}compareVersions(e,n){const t=e.split(".").map(Number),r=n.split(".").map(Number);for(let e=0;e<Math.max(t.length,r.length);e++){const n=t[e]||0,a=r[e]||0;if(n>a)return 1;if(n<a)return-1}return 0}showUpdateNotification(e){const n=document.getElementById("coretabs-update-notification");n&&n.remove();const t=document.createElement("div");t.id="coretabs-update-notification",t.className="coretabs-update-notification";const r=document.createElement("div");r.className="update-title",r.textContent=c("update.available"),t.appendChild(r);const a=document.createElement("div");a.className="update-message",a.textContent=`${c("update.newVersion")} ${e}`,t.appendChild(a);const o=document.createElement("div");o.className="update-buttons";const s=document.createElement("button");s.textContent=c("update.install"),s.onclick=function(){window.open(this.updateUrl,"_blank"),t.remove()}.bind(this),o.appendChild(s);const i=document.createElement("button");i.textContent=c("common.close"),i.onclick=function(){t.remove()},o.appendChild(i),t.appendChild(o),document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.remove()},1e4)}createUpdateNotification(e){const n=document.createElement("div");n.className="coretabs-update-notification",n.style.cssText="\n        position: fixed;\n        top: 20px;\n        right: 20px;\n        background: white;\n        border: 1px solid #ddd;\n        border-radius: 8px;\n        padding: 20px;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n        z-index: 10000;\n        max-width: 400px;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    ";const t=document.createElement("div");t.className="coretabs-update-content";const r=document.createElement("div");r.className="coretabs-update-header";const a=document.createElement("h3");a.textContent=c("update.available","Update Available"),a.style.margin="0 0 10px 0";const o=document.createElement("button");o.className="coretabs-update-close",o.textContent="×",o.style.cssText="float: right; background: none; border: none; font-size: 20px; cursor: pointer;",o.onclick=()=>n.remove(),r.appendChild(a),r.appendChild(o);const s=document.createElement("div");s.className="coretabs-update-body";const i=document.createElement("p");i.textContent=c("update.newVersion","A new version of CoreTabs is available!");const d=document.createElement("p"),l=document.createElement("strong");l.textContent=`${c("update.current","Current")}: ${e.currentVersion}`,d.appendChild(l);const p=document.createElement("p"),u=document.createElement("strong");if(u.textContent=`${c("update.latest","Latest")}: ${e.latestVersion}`,p.appendChild(u),s.appendChild(i),s.appendChild(d),s.appendChild(p),e.changelog.length>0){const n=document.createElement("div");n.className="coretabs-update-changelog";const t=document.createElement("h4");t.textContent=c("update.changelog","What's New:"),n.appendChild(t);const r=document.createElement("ul");e.changelog.forEach(e=>{const n=document.createElement("li");n.textContent=e,r.appendChild(n)}),n.appendChild(r),s.appendChild(n)}const m=document.createElement("div");m.className="coretabs-update-actions",m.style.cssText="margin-top: 15px; text-align: right;";const b=document.createElement("a");b.href=e.downloadUrl,b.className="coretabs-update-btn coretabs-update-btn-primary",b.textContent=c("update.install","Install Update"),b.style.cssText="display: inline-block; padding: 8px 16px; margin: 0 5px; background: #007cba; color: white; text-decoration: none; border-radius: 4px;";const g=document.createElement("button");g.className="coretabs-update-btn coretabs-update-btn-secondary",g.textContent=c("update.later","Later"),g.style.cssText="padding: 8px 16px; margin: 0 5px; background: #f0f0f0; border: 1px solid #ccc; border-radius: 4px; cursor: pointer;",g.onclick=()=>n.remove();const h=document.createElement("button");return h.className="coretabs-update-btn coretabs-update-btn-text",h.textContent=c("update.skip","Skip This Version"),h.style.cssText="padding: 8px 16px; margin: 0 5px; background: none; border: none; color: #666; cursor: pointer;",h.onclick=()=>{localStorage.setItem("coretabs_skip_version",e.latestVersion),n.remove()},m.appendChild(b),m.appendChild(g),m.appendChild(h),t.appendChild(r),t.appendChild(s),t.appendChild(m),n.appendChild(t),this.injectUpdateStyles(),n}injectUpdateStyles(){if(document.querySelector("#coretabs-update-styles"))return;const e=document.createElement("style");e.id="coretabs-update-styles",e.textContent="\n        .coretabs-update-notification {\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            width: 350px;\n            background: white;\n            border: 1px solid #ddd;\n            border-radius: 8px;\n            box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n            z-index: 10000;\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n            font-size: 14px;\n            animation: slideInRight 0.3s ease-out;\n        }\n        \n        @keyframes slideInRight {\n            from { transform: translateX(100%); opacity: 0; }\n            to { transform: translateX(0); opacity: 1; }\n        }\n        \n        .coretabs-update-content {\n            padding: 0;\n        }\n        \n        .coretabs-update-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 15px 20px 10px;\n            border-bottom: 1px solid #eee;\n        }\n        \n        .coretabs-update-header h3 {\n            margin: 0;\n            color: #333;\n            font-size: 16px;\n            font-weight: 600;\n        }\n        \n        .coretabs-update-close {\n            background: none;\n            border: none;\n            font-size: 20px;\n            cursor: pointer;\n            color: #999;\n            padding: 0;\n            width: 24px;\n            height: 24px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        }\n        \n        .coretabs-update-close:hover {\n            color: #666;\n        }\n        \n        .coretabs-update-body {\n            padding: 15px 20px;\n        }\n        \n        .coretabs-update-body p {\n            margin: 0 0 8px 0;\n            color: #555;\n            line-height: 1.4;\n        }\n        \n        .coretabs-update-changelog {\n            margin-top: 12px;\n            padding-top: 12px;\n            border-top: 1px solid #f0f0f0;\n        }\n        \n        .coretabs-update-changelog h4 {\n            margin: 0 0 8px 0;\n            font-size: 14px;\n            color: #333;\n        }\n        \n        .coretabs-update-changelog ul {\n            margin: 0;\n            padding-left: 18px;\n        }\n        \n        .coretabs-update-changelog li {\n            margin-bottom: 4px;\n            color: #666;\n            font-size: 13px;\n        }\n        \n        .coretabs-update-actions {\n            padding: 15px 20px;\n            border-top: 1px solid #eee;\n            display: flex;\n            gap: 8px;\n            flex-wrap: wrap;\n        }\n        \n        .coretabs-update-btn {\n            padding: 8px 16px;\n            border-radius: 4px;\n            text-decoration: none;\n            font-size: 13px;\n            font-weight: 500;\n            cursor: pointer;\n            border: 1px solid transparent;\n            transition: all 0.2s;\n        }\n        \n        .coretabs-update-btn-primary {\n            background: #007cba;\n            color: white;\n        }\n        \n        .coretabs-update-btn-primary:hover {\n            background: #005a87;\n        }\n        \n        .coretabs-update-btn-secondary {\n            background: #f8f9fa;\n            color: #495057;\n            border-color: #dee2e6;\n        }\n        \n        .coretabs-update-btn-secondary:hover {\n            background: #e9ecef;\n        }\n        \n        .coretabs-update-btn-text {\n            background: none;\n            color: #6c757d;\n            padding: 8px 12px;\n        }\n        \n        .coretabs-update-btn-text:hover {\n            color: #495057;\n            background: #f8f9fa;\n        }\n    ",document.head.appendChild(e)}async manualCheck(){return await this.checkForUpdates(!0)}},h="undefined"!=typeof __VERSION__?__VERSION__:"1.0.0";class f{constructor(){this.initialized=!1,this.version=h,this.updateChecker=new g,this.injectStyles()}injectStyles(){if(document.querySelector("style[data-coretabs]"))return;const e=document.createElement("style");e.setAttribute("data-coretabs","true"),e.textContent=":root {\r\n  --primary-color: #1976d2;\r\n  --secondary-color: #424242;\r\n  --success-color: #4caf50;\r\n  --warning-color: #ff9800;\r\n  --error-color: #f44336;\r\n  --info-color: #2196f3;\r\n  \r\n  --text-primary: #212121;\r\n  --text-secondary: #757575;\r\n  --text-disabled: #bdbdbd;\r\n  \r\n  --background-primary: #ffffff;\r\n  --background-secondary: #f5f5f5;\r\n  --background-paper: #ffffff;\r\n  \r\n  --border-color: #e0e0e0;\r\n  --divider-color: #e0e0e0;\r\n  \r\n  --shadow-1: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);\r\n  --shadow-2: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);\r\n  --shadow-3: 0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23);\r\n  \r\n  --border-radius: 4px;\r\n  --border-radius-large: 8px;\r\n  \r\n  --font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\r\n  --font-size-small: 12px;\r\n  --font-size-normal: 14px;\r\n  --font-size-large: 16px;\r\n  --font-size-xlarge: 18px;\r\n  \r\n  --spacing-xs: 4px;\r\n  --spacing-sm: 8px;\r\n  --spacing-md: 16px;\r\n  --spacing-lg: 24px;\r\n  --spacing-xl: 32px;\r\n  \r\n  --transition-fast: 0.15s ease;\r\n  --transition-normal: 0.3s ease;\r\n  --transition-slow: 0.5s ease;\r\n}/* CoreTabs Styles */\r\n.coretabs-sidebar {\r\n  position: fixed;\r\n  top: 0;\r\n  right: -400px;\r\n  width: 400px;\r\n  height: 100vh;\r\n  background: var(--background-paper);\r\n  box-shadow: var(--shadow-3);\r\n  z-index: 10000;\r\n  transition: right var(--transition-normal);\r\n  font-family: var(--font-family);\r\n  font-size: var(--font-size-normal);\r\n  overflow: hidden;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.coretabs-sidebar.open {\r\n  right: 0;\r\n}\r\n\r\n.coretabs-header {\r\n  background: var(--primary-color);\r\n  color: white;\r\n  padding: var(--spacing-md);\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.coretabs-title {\r\n  font-size: var(--font-size-large);\r\n  font-weight: 600;\r\n  margin: 0;\r\n}\r\n\r\n.coretabs-close {\r\n  background: none;\r\n  border: none;\r\n  color: white;\r\n  font-size: var(--font-size-xlarge);\r\n  cursor: pointer;\r\n  padding: var(--spacing-xs);\r\n  border-radius: var(--border-radius);\r\n  transition: background-color var(--transition-fast);\r\n}\r\n\r\n.coretabs-close:hover {\r\n  background-color: rgba(255, 255, 255, 0.1);\r\n}\r\n\r\n.coretabs-content {\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  padding: var(--spacing-md);\r\n}\r\n\r\n.coretabs-profile {\r\n  background: var(--background-secondary);\r\n  padding: var(--spacing-md);\r\n  border-radius: var(--border-radius);\r\n  margin-bottom: var(--spacing-md);\r\n}\r\n\r\n.coretabs-profile-name {\r\n  font-weight: 600;\r\n  color: var(--text-primary);\r\n  margin-bottom: var(--spacing-xs);\r\n}\r\n\r\n.coretabs-profile-role {\r\n  color: var(--text-secondary);\r\n  font-size: var(--font-size-small);\r\n}\r\n\r\n.coretabs-tabs {\r\n  display: flex;\r\n  border-bottom: 1px solid var(--border-color);\r\n  margin-bottom: var(--spacing-md);\r\n}\r\n\r\n.coretabs-tab {\r\n  background: none;\r\n  border: none;\r\n  padding: var(--spacing-sm) var(--spacing-md);\r\n  cursor: pointer;\r\n  border-bottom: 2px solid transparent;\r\n  transition: all var(--transition-fast);\r\n  color: var(--text-secondary);\r\n  font-size: var(--font-size-normal);\r\n}\r\n\r\n.coretabs-tab.active {\r\n  color: var(--primary-color);\r\n  border-bottom-color: var(--primary-color);\r\n}\r\n\r\n.coretabs-tab:hover {\r\n  background-color: var(--background-secondary);\r\n}\r\n\r\n.coretabs-tab-content {\r\n  display: none;\r\n}\r\n\r\n.coretabs-tab-content.active {\r\n  display: block;\r\n}\r\n\r\n.coretabs-loading {\r\n  text-align: center;\r\n  padding: var(--spacing-lg);\r\n  color: var(--text-secondary);\r\n}\r\n\r\n.coretabs-error {\r\n  background: #ffebee;\r\n  color: var(--error-color);\r\n  padding: var(--spacing-md);\r\n  border-radius: var(--border-radius);\r\n  margin-bottom: var(--spacing-md);\r\n  border-left: 4px solid var(--error-color);\r\n}\r\n\r\n.coretabs-toggle {\r\n  position: fixed;\r\n  top: 20px;\r\n  right: 20px;\r\n  background: var(--primary-color);\r\n  color: white;\r\n  border: none;\r\n  width: 50px;\r\n  height: 50px;\r\n  border-radius: 50%;\r\n  cursor: pointer;\r\n  box-shadow: var(--shadow-2);\r\n  z-index: 9999;\r\n  font-size: var(--font-size-large);\r\n  transition: all var(--transition-fast);\r\n}\r\n\r\n.coretabs-toggle:hover {\r\n  transform: scale(1.1);\r\n  box-shadow: var(--shadow-3);\r\n}\r\n\r\n.coretabs-table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n  margin-bottom: var(--spacing-md);\r\n}\r\n\r\n.coretabs-table th,\r\n.coretabs-table td {\r\n  padding: var(--spacing-sm);\r\n  text-align: left;\r\n  border-bottom: 1px solid var(--border-color);\r\n  font-size: var(--font-size-small);\r\n}\r\n\r\n.coretabs-table th {\r\n  background: var(--background-secondary);\r\n  font-weight: 600;\r\n  color: var(--text-primary);\r\n}\r\n\r\n.coretabs-table tr:hover {\r\n  background: var(--background-secondary);\r\n}\r\n\r\n.coretabs-badge {\r\n  display: inline-block;\r\n  padding: 2px 8px;\r\n  border-radius: 12px;\r\n  font-size: 11px;\r\n  font-weight: 500;\r\n  text-transform: uppercase;\r\n}\r\n\r\n.coretabs-badge.status-active {\r\n  background: #e8f5e8;\r\n  color: var(--success-color);\r\n}\r\n\r\n.coretabs-badge.status-pending {\r\n  background: #fff3e0;\r\n  color: var(--warning-color);\r\n}\r\n\r\n.coretabs-badge.status-completed {\r\n  background: #e3f2fd;\r\n  color: var(--info-color);\r\n}/* Responsive styles */\r\n@media (max-width: 768px) {\r\n  .coretabs-sidebar {\r\n    width: 100vw;\r\n    right: -100vw;\r\n  }\r\n  \r\n  .coretabs-sidebar.open {\r\n    right: 0;\r\n  }\r\n  \r\n  .coretabs-toggle {\r\n    top: 10px;\r\n    right: 10px;\r\n    width: 40px;\r\n    height: 40px;\r\n    font-size: var(--font-size-normal);\r\n  }\r\n  \r\n  .coretabs-content {\r\n    padding: var(--spacing-sm);\r\n  }\r\n  \r\n  .coretabs-table {\r\n    font-size: 11px;\r\n  }\r\n  \r\n  .coretabs-table th,\r\n  .coretabs-table td {\r\n    padding: var(--spacing-xs);\r\n  }\r\n}\r\n\r\n@media (max-width: 480px) {\r\n  .coretabs-header {\r\n    padding: var(--spacing-sm);\r\n  }\r\n  \r\n  .coretabs-title {\r\n    font-size: var(--font-size-normal);\r\n  }\r\n  \r\n  .coretabs-tabs {\r\n    flex-wrap: wrap;\r\n  }\r\n  \r\n  .coretabs-tab {\r\n    flex: 1;\r\n    min-width: 80px;\r\n    padding: var(--spacing-xs) var(--spacing-sm);\r\n    font-size: var(--font-size-small);\r\n  }\r\n}",document.head.appendChild(e)}async init(){var e;if(!this.initialized)try{this.initialized=!0,s[e=i]&&(i=e,localStorage.setItem(r.I18N_STORAGE_KEY,e)),function(){const e=document.getElementById("coretabs-sidebar");e&&e.remove();const n=document.createElement("div");n.id="coretabs-sidebar",n.className="coretabs-sidebar";const t=document.createElement("div");t.className="coretabs-header";const r=document.createElement("h2");r.className="coretabs-title",r.textContent=c("app.title");const a=document.createElement("button");a.className="coretabs-close",a.id="coretabs-close",a.textContent="×",t.appendChild(r),t.appendChild(a);const o=document.createElement("div");o.className="coretabs-content";const s=document.createElement("div");s.className="coretabs-profile",s.id="coretabs-profile";const i=document.createElement("div");i.className="coretabs-loading",i.textContent=c("common.loading"),s.appendChild(i);const d=document.createElement("div");d.className="coretabs-tabs";const l=document.createElement("button");l.className="coretabs-tab active",l.setAttribute("data-tab","cases"),l.textContent=c("tabs.cases");const p=document.createElement("button");p.className="coretabs-tab",p.setAttribute("data-tab","documents"),p.textContent=c("tabs.documents");const u=document.createElement("button");u.className="coretabs-tab",u.setAttribute("data-tab","routing"),u.textContent=c("tabs.routing"),d.appendChild(l),d.appendChild(p),d.appendChild(u);const m=document.createElement("div");m.className="coretabs-tab-content active",m.id="tab-cases";const b=document.createElement("div");b.className="coretabs-loading",b.textContent=c("common.loading"),m.appendChild(b);const g=document.createElement("div");g.className="coretabs-tab-content",g.id="tab-documents";const h=document.createElement("div");h.className="coretabs-loading",h.textContent=c("common.loading"),g.appendChild(h);const f=document.createElement("div");f.className="coretabs-tab-content",f.id="tab-routing";const x=document.createElement("div");x.className="coretabs-loading",x.textContent=c("common.loading"),f.appendChild(x),o.appendChild(s),o.appendChild(d),o.appendChild(m),o.appendChild(g),o.appendChild(f),n.appendChild(t),n.appendChild(o);const v=document.createElement("button");v.id="coretabs-toggle",v.className="coretabs-toggle",v.textContent="📋",v.title=c("app.toggle"),document.body.appendChild(n),document.body.appendChild(v)}(),await async function(){try{const e=d();if(!e)throw new Error("No authentication token available");const n=await fetch("/api/profile",{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!n.ok)throw new Error(`Profile fetch failed: ${n.status}`);const t=await n.json();return localStorage.setItem(r.PROFILE_STORAGE_KEY,JSON.stringify(t)),p(t),t}catch(e){throw p(null),e}}(),m(),b(),function(){try{const e=localStorage.getItem(SIDEBAR_STATE_KEY);return e?JSON.parse(e):null}catch(e){return null}}(),await u()}catch(e){throw new Error(`CoreTabs initialization failed: ${e.message}`)}}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{(new f).init()}):(new f).init()})();